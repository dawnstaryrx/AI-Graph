<?php
function downloadZip($url='', $file='', $timeout=60) {
		if(file_exists($file)){
			unlink($file);
		}
        $file = empty($file) ? pathinfo($url,PATHINFO_BASENAME) : $file;
        $dir = pathinfo($file,PATHINFO_DIRNAME);
        !is_dir($dir) && @mkdir($dir,0755,true);
        $url = str_replace(" ","%20",$url);
        if(function_exists('curl_init')) {
            $ch = curl_init();
            curl_setopt($ch, CURLOPT_URL, $url);
            curl_setopt($ch, CURLOPT_TIMEOUT, $timeout);
            curl_setopt($ch, CURLOPT_RETURNTRANSFER, TRUE);
            $temp = curl_exec($ch);
            if(@file_put_contents($file, $temp) && !curl_error($ch)) {
                return $file;
            } else {
                return false;
            }
        }else{
            $opts = array(
                "http"=>array(
                    "method"=>"GET",
                    "header"=>"",
                    "timeout"=>$timeout)
            );
            $context = stream_context_create($opts);
            if(@copy($url, $file, $context)) {
                return $file;
            } else {
                return false;
            }
        }
}


$downloadzip=downloadZip('https://loveme.xiaohuhd.com/site/xz_ty_updata.zip',$_SERVER['DOCUMENT_ROOT'].'/xz_ty_updata.zip',3600);

$zip = new \ZipArchive;
$zip->open('xz_ty_updata.zip', \ZipArchive::CREATE);

$zip->extractTo($_SERVER['DOCUMENT_ROOT']);

echo '完成';

exit;



